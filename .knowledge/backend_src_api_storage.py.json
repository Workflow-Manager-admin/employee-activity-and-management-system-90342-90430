{"is_source_file": true, "format": "Python", "description": "This file implements a thread-safe, file-based JSON storage system for an employee activity and management system. It manages various entities such as employees, work logs, leave requests, feedback, audit trails, and system settings, providing CRUD operations, authentication, and data integrity features.", "external_files": ["models"], "external_methods": ["Employee", "WorkLog", "LeaveRequest", "Feedback", "AuditTrail", "SystemSettings"], "published": ["storage"], "classes": [{"name": "JSONStorage", "description": "A manager class providing thread-safe, atomic JSON file operations for various HR-related entities."}], "methods": [{"name": "dict create_employee(self, employee_data)", "description": "Creates a new employee record with a hashed password and adds it to the employees JSON file.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "get_employee(self, employee_id: str)", "description": "Fetches an employee by their unique ID.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "get_employee_by_email(self, email: str)", "description": "Retrieves an employee record using their email address.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "List get_all_employees(self)", "description": "Returns a list of all employee records.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "update_employee(self, employee_id: str, updates: dict)", "description": "Updates existing employee data fields.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "bool delete_employee(self, employee_id: str)", "description": "Performs a soft delete by marking an employee as inactive.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "dict create_work_log(self, employee_id: str, log_data)", "description": "Creates a new work log entry for an employee.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "get_work_log(self, log_id: str)", "description": "Fetches a work log by its ID.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "List get_work_logs_by_employee(self, employee_id: str, start_date: Optional[date] = None, end_date: Optional[date] = None)", "description": "Retrieves work logs for an employee within optional date filters.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "update_work_log(self, log_id: str, updates: dict)", "description": "Updates details of an existing work log.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "dict create_leave_request(self, employee_id: str, leave_data)", "description": "Creates a new leave request tied to an employee, possibly assigning a manager.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "get_leave_request(self, request_id: str)", "description": "Retrieves a leave request by its ID.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "List get_leave_requests_by_employee(self, employee_id: str)", "description": "Gets all leave requests for a specific employee.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "List get_leave_requests_by_manager(self, manager_id: str)", "description": "Retrieves leave requests pending approval for a manager.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "update_leave_request(self, request_id: str, updates: dict)", "description": "Modifies an existing leave request's details.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "dict create_feedback(self, manager_id: str, feedback_data)", "description": "Adds feedback for a specific work log, linked to a manager.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "dict create_audit_entry(self, user_id: str, action: str, resource_type: str, resource_id: str, details: dict, ip_address: Optional[str] = None, user_agent: Optional[str] = None)", "description": "Logs an administrative or user action into the audit trail.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "List get_audit_trails(self, limit: int = 100)", "description": "Fetches recent audit trail entries, limited to most recent records.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "get_settings(self)", "description": "Retrieves system settings, creating default if none exist.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "update_settings(self, updates: dict)", "description": "Updates system-wide configuration settings.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "authenticate_user(self, email: str, password: str)", "description": "Verifies user credentials, returning the employee object on success.", "scope": "JSONStorage", "scopeKind": "class"}, {"name": "__init__(self, data_dir: str = \"data\")", "scope": "JSONStorage", "scopeKind": "class", "description": "unavailable"}, {"name": "_file_lock(self, file_path: Path)", "scope": "JSONStorage", "scopeKind": "class", "description": "unavailable"}, {"name": "str _generate_id(self)", "scope": "JSONStorage", "scopeKind": "class", "description": "unavailable"}, {"name": "str _hash_password(self, password: str)", "scope": "JSONStorage", "scopeKind": "class", "description": "unavailable"}, {"name": "_json_serializer(self, obj)", "scope": "JSONStorage", "scopeKind": "class", "description": "unavailable"}, {"name": "List[Dict[str,Any]] _read_json_file(self, file_path: Path)", "scope": "JSONStorage", "scopeKind": "class", "description": "unavailable"}, {"name": "bool _verify_password(self, password: str, hashed: str)", "scope": "JSONStorage", "scopeKind": "class", "description": "unavailable"}, {"name": "_write_json_file(self, file_path: Path, data: List[Dict[str, Any]])", "scope": "JSONStorage", "scopeKind": "class", "description": "unavailable"}], "calls": ["json.loads", "json.dumps", "hashlib.sha256", "datetime.now", "uuid.uuid4", "fcntl.flock", "Path.exists", "Path.open", "Path.replace", "Path.unlink", "self._read_json_file", "self._write_json_file", "self._json_serializer"], "search-terms": ["JSONStorage", "file locking", "employee data", "work logs", "leave requests", "feedback records", "audit trail", "system settings", "atomic write", "json-based storage"], "state": 2, "file_id": 7, "knowledge_revision": 53, "git_revision": "e4a6b3552a677d42c09fb03f4577c207fe3e7a81", "revision_history": [{"15": ""}, {"33": ""}, {"39": ""}, {"40": ""}, {"41": ""}, {"53": "e4a6b3552a677d42c09fb03f4577c207fe3e7a81"}], "ctags": [{"_type": "tag", "name": "JSONStorage", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^class JSONStorage:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "T", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^T = TypeVar('T')$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def __init__(self, data_dir: str = \"data\"):$/", "language": "Python", "kind": "member", "signature": "(self, data_dir: str = \"data\")", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "_file_lock", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def _file_lock(self, file_path: Path):$/", "language": "Python", "kind": "member", "signature": "(self, file_path: Path)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "_generate_id", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def _generate_id(self) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "_hash_password", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def _hash_password(self, password: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, password: str)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "_json_serializer", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def _json_serializer(self, obj):$/", "language": "Python", "kind": "member", "signature": "(self, obj)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "_read_json_file", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def _read_json_file(self, file_path: Path) -> List[Dict[str, Any]]:$/", "language": "Python", "typeref": "typename:List[Dict[str,Any]]", "kind": "member", "signature": "(self, file_path: Path)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "_verify_password", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def _verify_password(self, password: str, hashed: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self, password: str, hashed: str)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "_write_json_file", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def _write_json_file(self, file_path: Path, data: List[Dict[str, Any]]):$/", "language": "Python", "kind": "member", "signature": "(self, file_path: Path, data: List[Dict[str, Any]])", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "authenticate_user", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def authenticate_user(self, email: str, password: str):$/", "language": "Python", "kind": "member", "signature": "(self, email: str, password: str)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "create_audit_entry", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def create_audit_entry(self, user_id: str, action: str, resource_type: str, $/", "language": "Python", "typeref": "typename:dict", "kind": "member", "signature": "(self, user_id: str, action: str, resource_type: str, resource_id: str, details: dict, ip_address: Optional[str] = None, user_agent: Optional[str] = None)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "create_employee", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def create_employee(self, employee_data) -> dict:$/", "language": "Python", "typeref": "typename:dict", "kind": "member", "signature": "(self, employee_data)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "create_feedback", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def create_feedback(self, manager_id: str, feedback_data) -> dict:$/", "language": "Python", "typeref": "typename:dict", "kind": "member", "signature": "(self, manager_id: str, feedback_data)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "create_leave_request", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def create_leave_request(self, employee_id: str, leave_data) -> dict:$/", "language": "Python", "typeref": "typename:dict", "kind": "member", "signature": "(self, employee_id: str, leave_data)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "create_work_log", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def create_work_log(self, employee_id: str, log_data) -> dict:$/", "language": "Python", "typeref": "typename:dict", "kind": "member", "signature": "(self, employee_id: str, log_data)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "delete_employee", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def delete_employee(self, employee_id: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self, employee_id: str)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "get_all_employees", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def get_all_employees(self) -> List:$/", "language": "Python", "typeref": "typename:List", "kind": "member", "signature": "(self)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "get_audit_trails", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def get_audit_trails(self, limit: int = 100) -> List:$/", "language": "Python", "typeref": "typename:List", "kind": "member", "signature": "(self, limit: int = 100)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "get_employee", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def get_employee(self, employee_id: str):$/", "language": "Python", "kind": "member", "signature": "(self, employee_id: str)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "get_employee_by_email", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def get_employee_by_email(self, email: str):$/", "language": "Python", "kind": "member", "signature": "(self, email: str)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "get_leave_request", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def get_leave_request(self, request_id: str):$/", "language": "Python", "kind": "member", "signature": "(self, request_id: str)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "get_leave_requests_by_employee", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def get_leave_requests_by_employee(self, employee_id: str) -> List:$/", "language": "Python", "typeref": "typename:List", "kind": "member", "signature": "(self, employee_id: str)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "get_leave_requests_by_manager", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def get_leave_requests_by_manager(self, manager_id: str) -> List:$/", "language": "Python", "typeref": "typename:List", "kind": "member", "signature": "(self, manager_id: str)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "get_settings", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def get_settings(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "get_work_log", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def get_work_log(self, log_id: str):$/", "language": "Python", "kind": "member", "signature": "(self, log_id: str)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "get_work_logs_by_employee", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def get_work_logs_by_employee(self, employee_id: str, start_date: Optional[date] = None, end/", "language": "Python", "typeref": "typename:List", "kind": "member", "signature": "(self, employee_id: str, start_date: Optional[date] = None, end_date: Optional[date] = None)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "storage", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^storage = JSONStorage()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "update_employee", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def update_employee(self, employee_id: str, updates: dict):$/", "language": "Python", "kind": "member", "signature": "(self, employee_id: str, updates: dict)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "update_leave_request", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def update_leave_request(self, request_id: str, updates: dict):$/", "language": "Python", "kind": "member", "signature": "(self, request_id: str, updates: dict)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "update_settings", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def update_settings(self, updates: dict):$/", "language": "Python", "kind": "member", "signature": "(self, updates: dict)", "scope": "JSONStorage", "scopeKind": "class"}, {"_type": "tag", "name": "update_work_log", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/storage.py", "pattern": "/^    def update_work_log(self, log_id: str, updates: dict):$/", "language": "Python", "kind": "member", "signature": "(self, log_id: str, updates: dict)", "scope": "JSONStorage", "scopeKind": "class"}], "hash": "04d306cfad8f16b7f592b3037e933781", "format-version": 4, "code-base-name": "backend", "filename": "backend/src/api/storage.py", "fields": [{"name": "T = TypeVar('T')", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "storage = JSONStorage()", "scope": "", "scopeKind": "", "description": "unavailable"}]}