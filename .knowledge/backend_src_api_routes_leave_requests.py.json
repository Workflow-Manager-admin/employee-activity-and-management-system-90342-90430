{"is_source_file": true, "format": "Python (FastAPI)", "description": "This file defines API routes for managing employee leave requests, including creation, retrieval, updating, approval/rejection, and cancellation, with permission checks and audit logging.", "external_files": ["../models", "../storage", "../auth"], "external_methods": ["storage.create_leave_request", "storage.get_leave_requests_by_employee", "storage._read_json_file", "storage.get_leave_request", "storage.update_leave_request", "storage.create_audit_entry", "get_current_user", "can_approve_leave"], "published": ["router"], "classes": [{"name": "LeaveRequest", "description": "Model representing a leave request"}, {"name": "LeaveRequestCreate", "description": "Input model for creating a leave request"}, {"name": "LeaveRequestUpdate", "description": "Input model for updating a leave request"}, {"name": "LeaveRequestApproval", "description": "Model for approval or rejection of leave requests"}, {"name": "Employee", "description": "Model representing an employee/user"}, {"name": "LeaveStatus", "description": "Enum representing leave request statuses"}, {"name": "ActionType", "description": "Enum representing audit action types (CREATE, UPDATE, APPROVE, REJECT, DELETE)"}], "methods": [{"name": "create_leave_request( leave_data: LeaveRequestCreate, current_user: Employee = Depends(get_current_user) )", "description": "Creates a new leave request for the current user with date validation and audit logging", "scope": "", "scopeKind": ""}, {"name": "get_leave_requests( status_filter: Optional[LeaveStatus] = None, current_user: Employee = Depends(get_current_user) )", "description": "Retrieves leave requests for the current user, optionally filtered by status", "scope": "", "scopeKind": ""}, {"name": "get_pending_approvals( current_user: Employee = Depends(get_current_user) )", "description": "Retrieves pending leave requests for managers/admins", "scope": "", "scopeKind": ""}, {"name": "get_leave_request( request_id: str, current_user: Employee = Depends(get_current_user) )", "description": "Retrieves a specific leave request if authorized", "scope": "", "scopeKind": ""}, {"name": "update_leave_request( request_id: str, leave_update: LeaveRequestUpdate, current_user: Employee = Depends(get_current_user) )", "description": "Updates a leave request if it is pending and belongs to the current user", "scope": "", "scopeKind": ""}, {"name": "approve_or_reject_leave_request( request_id: str, approval_data: LeaveRequestApproval, current_user: Employee = Depends(get_current_user) )", "description": "Allows managers/admins to approve or reject a leave request, with audit logging", "scope": "", "scopeKind": ""}, {"name": "cancel_leave_request( request_id: str, current_user: Employee = Depends(get_current_user) )", "description": "Allows the owner to cancel their own pending leave request", "scope": "", "scopeKind": ""}], "calls": ["storage.create_leave_request", "storage.create_audit_entry", "storage.get_leave_requests_by_employee", "storage._read_json_file", "storage.get_leave_request", "storage.update_leave_request", "storage.create_audit_entry", "storage.get_leave_requests_by_manager", "storage.update_leave_request"], "search-terms": ["leave-requests", "API routes", "approval system", "employee leave management", "leave request creation", "manager approval", "leave request update", "cancel leave", "audit logging"], "state": 2, "file_id": 11, "knowledge_revision": 34, "git_revision": "", "revision_history": [{"23": ""}, {"34": ""}], "ctags": [{"_type": "tag", "name": "approve_or_reject_leave_request", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/routes/leave_requests.py", "pattern": "/^async def approve_or_reject_leave_request($/", "language": "Python", "kind": "function", "signature": "( request_id: str, approval_data: LeaveRequestApproval, current_user: Employee = Depends(get_current_user) )"}, {"_type": "tag", "name": "cancel_leave_request", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/routes/leave_requests.py", "pattern": "/^async def cancel_leave_request($/", "language": "Python", "kind": "function", "signature": "( request_id: str, current_user: Employee = Depends(get_current_user) )"}, {"_type": "tag", "name": "create_leave_request", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/routes/leave_requests.py", "pattern": "/^async def create_leave_request($/", "language": "Python", "kind": "function", "signature": "( leave_data: LeaveRequestCreate, current_user: Employee = Depends(get_current_user) )"}, {"_type": "tag", "name": "get_leave_request", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/routes/leave_requests.py", "pattern": "/^async def get_leave_request($/", "language": "Python", "kind": "function", "signature": "( request_id: str, current_user: Employee = Depends(get_current_user) )"}, {"_type": "tag", "name": "get_leave_requests", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/routes/leave_requests.py", "pattern": "/^async def get_leave_requests($/", "language": "Python", "kind": "function", "signature": "( status_filter: Optional[LeaveStatus] = None, current_user: Employee = Depends(get_current_user) )"}, {"_type": "tag", "name": "get_pending_approvals", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/routes/leave_requests.py", "pattern": "/^async def get_pending_approvals($/", "language": "Python", "kind": "function", "signature": "( current_user: Employee = Depends(get_current_user) )"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/routes/leave_requests.py", "pattern": "/^router = APIRouter(prefix=\"\\/leave-requests\", tags=[\"leave-requests\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "update_leave_request", "path": "/home/kavia/workspace/code-generation/employee-activity-and-management-system-90342-90430/backend/src/api/routes/leave_requests.py", "pattern": "/^async def update_leave_request($/", "language": "Python", "kind": "function", "signature": "( request_id: str, leave_update: LeaveRequestUpdate, current_user: Employee = Depends(get_current_user) )"}], "hash": "c005a40bd3d4a68df38c4223fda810b7", "format-version": 4, "code-base-name": "backend", "filename": "backend/src/api/routes/leave_requests.py", "fields": [{"name": "router = APIRouter(prefix=\"\\/leave-requests\", tags=[\"leave-requests\"])", "scope": "", "scopeKind": "", "description": "unavailable"}]}